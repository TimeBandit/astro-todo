---
import { TodosList } from "@/components/TodosList";
import Content from "../components/Content.astro";

import "../styles/global.css";
import Layout from "@/layouts/Layout.astro";
import NavBar from "@/components/NavBar.astro";
import { Button } from "@/components/ui/button";
---

<Layout>
  <NavBar>
    <Button id="signOut" className="">Logout</Button>
  </NavBar>
  <div class="flex min-h-svh w-full items-center justify-center p-6 md:p-10">
    <div class="w-full max-w-sm">
      <Content>
        <TodosList client:load />
      </Content>
    </div>
  </div>
</Layout>
<script>
  import { signOutRedirect, userManager } from "@/lib/auth.ts";
import type { User } from "oidc-client-ts";

  document.getElementById("signOut")!.addEventListener("click", async () => {
    await signOutRedirect();
  });

  (async () => {
    try {
      const user: User | undefined = await userManager.signinCallback();
      console.log(user);
    } catch (error) {
      console.error(error);
    }
  })();
</script>
<style>
  #todo {
    display: block;
  }
</style>
